<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ayasofya Charity</title>
  <style>
    body { font-family: Arial; text-align:center; background:#f9f9f9; padding:20px; }
    .logo { width: 220px; height:auto; border-radius:12px; }
    button { background-color: purple; color:white; padding:10px 20px; border:none; border-radius:8px; cursor:pointer; margin-top:10px; }
    button:disabled { background-color: #aaa; cursor: not-allowed; }
  </style>
</head>
<body>

  <img src="images/logo.png" alt="Ayasofya Logo" class="logo"><br><br>
  <h1>Ayasofya Charity</h1>

  <h2>HakkÄ±mÄ±zda</h2>
  <p>Ayasofya Charity, ihtiyaÃ§ sahiplerine destek olmak amacÄ±yla kurulmuÅŸ bir baÄŸÄ±ÅŸ platformudur. Pi Network aÄŸÄ± Ã¼zerinden gÃ¼venli ve ÅŸeffaf baÄŸÄ±ÅŸ yapÄ±lmasÄ±nÄ± saÄŸlar.</p>

  <h2>BaÄŸÄ±ÅŸ Yap</h2>

  <p id="wallet-status">ğŸ”„ BaÄŸlantÄ± kontrol ediliyor...</p>

  <section>
    <h3>BaÄŸÄ±ÅŸ MiktarÄ±nÄ± SeÃ§</h3>
    <select id="donation-amount">
      <option value="1">1 Pi</option>
      <option value="5">5 Pi</option>
      <option value="10">10 Pi</option>
    </select>
    <br><br>
    <button id="send-donation" disabled>BaÄŸÄ±ÅŸÄ± GÃ¶nder</button>
    <p id="payment-status" style="color:green; margin-top:10px;"></p>
  </section>

  <footer style="margin-top:20px;">Â© 2025 Ayasofya Charity | TÃ¼m haklarÄ± saklÄ±dÄ±r</footer>

  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <script>
    Pi.init({ version: "2.0" });

    const walletStatus = document.getElementById("wallet-status");
    const sendDonationButton = document.getElementById("send-donation");
    const paymentStatus = document.getElementById("payment-status");

    // Ã–nce cÃ¼zdan baÄŸlantÄ±sÄ±nÄ± kontrol et
    async function checkWallet() {
      try {
        const auth = await Pi.authenticate(['payments'], () => {});
        walletStatus.innerHTML = "âœ… Valide baÄŸlantÄ± saÄŸlandÄ±!";
        sendDonationButton.disabled = false; // Butonu aktif et
      } catch (err) {
        console.error("CÃ¼zdan baÄŸlantÄ±sÄ± hatasÄ±:", err);
        walletStatus.innerHTML = "âŒ CÃ¼zdan baÄŸlanamadÄ±. LÃ¼tfen Pi Browser iÃ§inde tekrar deneyin.";
        sendDonationButton.disabled = true;
      }
    }

    checkWallet();

    // BaÄŸÄ±ÅŸ gÃ¶nderme iÅŸlemi
    sendDonationButton.addEventListener("click", async () => {
      try {
        const amount = document.getElementById("donation-amount").value;
        const paymentData = {
          amount: amount,
          memo: "Ayasofya Charity BaÄŸÄ±ÅŸÄ±",
          metadata: { project: "Ayasofya Charity", type: "donation" }
        };

        const paymentCallbacks = {
          onReadyForServerApproval: (paymentId) => {
            console.log("Onay bekleniyor:", paymentId);
          },
          onReadyForServerCompletion: (paymentId, txid) => {
            console.log("TamamlandÄ±:", paymentId, txid);
            paymentStatus.innerHTML = "âœ… BaÄŸÄ±ÅŸ baÅŸarÄ±yla gÃ¶nderildi! TeÅŸekkÃ¼r ederiz ğŸ™";
          },
          onCancel: (paymentId) => {
            paymentStatus.innerHTML = "âŒ BaÄŸÄ±ÅŸ iptal edildi.";
          },
          onError: (error, payment) => {
            console.error("Hata:", error);
            paymentStatus.innerHTML = "âš ï¸ Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.";
          }
        };

        await Pi.createPayment(paymentData, paymentCallbacks);
      } catch (error) {
        console.error("BaÄŸÄ±ÅŸ hatasÄ±:", error);
        paymentStatus.innerHTML = "âš ï¸ BaÄŸÄ±ÅŸ iÅŸlemi baÅŸlatÄ±lamadÄ±.";
      }
    });
  </script>

</body>
</html>
